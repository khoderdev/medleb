import{r as c,R as A,g as u,j as e,L as R,h as E,i as L,l as P,A as d,m as T}from"./index-v6jWvit2.js";const h="countriesData",$=()=>{const[l,g]=c.useState([]),[n,x]=c.useState(""),[b,i]=c.useState(!0);localStorage.getItem("accessToken"),c.useEffect(()=>{(async()=>{try{let a=localStorage.getItem(h);a&&(g(JSON.parse(a)),i(!1));const y=(await d.get("/api/country/v1.0/countries")).data,t=await Promise.all(y.map(async s=>{try{const w=(await d.get(`/api/Governorates/v1.0/Governorates/${s.guid}`)).data,C=s.staticCountryGuid,H=await Promise.all(w.map(async o=>{try{const G=(await d.get(`/api/District/v1.0/district/${o.guid}`)).data;return{...o,districtsData:G}}catch(p){return console.log(`Error fetching districts data for governorate ${o.code}:`,p),o}}));return{...s,governoratesData:H,staticCountryGuid:C}}catch(m){return console.log(`Error fetching governorates data for country ${s.code}:`,m),s}}));g(t),i(!1),localStorage.setItem(h,JSON.stringify(t)),T.setItem("countriesData",t),sessionStorage.setItem("countriesData",JSON.stringify(t))}catch(a){console.log("Error fetching countries data:",a),i(!1)}})()},[]);const f=A.useMemo(()=>[{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Name (Arabic)",accessor:"nameAr"},{Header:"Governorate Code",accessor:"governoratesData[0].code"},{Header:"Governorate Name",accessor:"governoratesData[0].name"},{Header:"Governorate Name (Arabic)",accessor:"governoratesData[0].nameAr"},{Header:"District Code",accessor:"governoratesData[0].districtsData[0].code"},{Header:"District Name",accessor:"governoratesData[0].districtsData[0].name"},{Header:"District Name (Arabic)",accessor:"governoratesData[0].districtsData[0].nameAr"}],[]),{getTableProps:D,getTableBodyProps:v,headerGroups:j,rows:N,prepareRow:S}=u.useTable({columns:f,data:l},u.useSortBy);return l.filter(r=>r.name.toLowerCase().includes(n.toLowerCase())||r.code.toLowerCase().includes(n.toLowerCase())),e.jsxs("div",{className:" w-full mx-auto p-4 overflow-x-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Countries Info List"}),e.jsxs("div",{className:"flex justify-between items-center p-6",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"border border-gray-500 p-2 mb-4",value:n,onChange:r=>x(r.target.value)}),e.jsx(R,{to:"/geo/new",className:" med-btn-pri",children:"Add New"})]}),b?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("div",{className:"loader ease-linear rounded-full border-8 border-t-8 border-green-pri absolute top-80 right-50 h-20 w-20"})}):e.jsxs("table",{...D(),className:"border-collapse border border-gray-500 w-full",children:[e.jsx("thead",{children:j.map(r=>e.jsx("tr",{...r.getHeaderGroupProps(),children:r.headers.map(a=>e.jsxs("th",{...a.getHeaderProps(a.getSortByToggleProps()),className:"border border-gray-500 p-2",children:[a.render("Header"),e.jsx("span",{children:a.isSorted?a.isSortedDesc?e.jsx(E,{}):e.jsx(L,{}):e.jsx(P,{})})]}))}))}),e.jsx("tbody",{...v(),children:N.map(r=>(S(r),e.jsx("tr",{...r.getRowProps(),className:"border-b text-center border-gray-500",children:r.cells.map(a=>e.jsx("td",{...a.getCellProps(),className:"border-b border-gray-500 p-2",children:a.render("Cell")}))})))})]})]})};export{$ as default};
