import{r as l,p as v,j as e,L as o,b as m}from"./index-nT-sMeGS.js";import{H as w,a as k,s as y,l as D}from"./subs2-7PFll61o.js";const L="/assets/drugPlaceholder-nPeSUmuz.png";function I({className:u}){const[x,h]=l.useState([]),[p,i]=l.useState(!0),[d,f]=l.useState("");v(!1);const[n,j]=l.useState(null),t=l.useRef(!0);async function g(){try{console.log("Fetching drugs...");const s=await m.get("http://1.1.1.252:3500/drugs");if(console.log("Response data:",s.data),t.current){const r=N(s.data);console.log("Parsed data:",r),h(r),i(!1),console.log("Drugs loaded successfully.")}}catch(s){t.current&&(console.error("There's a problem listing the medications:",s),i(!1))}}const N=s=>Array.isArray(s)?s.reverse():typeof s=="object"&&s!==null?[s]:(console.error("Invalid response format: expected an array"),[]);l.useEffect(()=>{const s=async()=>{console.log("Fetching data on mount..."),await g()};if(s(),!n){console.log("Setting up polling interval...");const r=setInterval(()=>{console.log("Fetching data through polling..."),s()},5*60*1e3);j(r)}return()=>{n&&(console.log("Clearing polling interval..."),clearInterval(n)),t.current=!1,console.log("Component unmounted.")}},[n]);function b(s){console.log(`Deleting drug with ID: ${s}`),m.delete(`http://1.1.1.252:3500/drugs/${s}`).then(()=>{console.log("Drug deleted successfully. Reloading drugs..."),g()}).catch(r=>{console.error("Error deleting drug:",r)})}const a=x.filter(s=>{const r=s.drugName&&s.drugName.toLowerCase(),c=d.toLowerCase();return r&&r.includes(c)});return console.log("Rendering List component with drugs:",a),e.jsxs("div",{className:`flex flex-col sm:p-4 ${u}`,children:[e.jsxs("div",{className:"mb-4 flex flex-col justify-center items-center",children:[e.jsx("label",{className:"text-green-pri text-3xl mb-2",children:"Search"}),e.jsx("input",{type:"text",value:d,onChange:s=>f(s.target.value),className:"w-full sm:w-[50%] p-2 rounded-full border border-[#00a65100] dark:border-black-border bg-white-bg dark:bg-black-input px-4 py-2 font-normal shadow-md dark:shadow-black-shadow outline-none focus:border-green-pri focus:outline-none focus:ring-2 focus:ring-green-pri dark:focus:ring-2 dark:focus:ring-green-pri"})]}),p?e.jsx("p",{children:"Loading..."}):a.length===0?e.jsxs("p",{className:"mb-4 text-2xl text-gray-600",children:["No Drugs Data Available. Click"," ",e.jsx(o,{to:"/add",className:"font-semibold text-teal-600 hover:underline mx-2",children:"Add"}),"to create a new drug."]}):e.jsx("div",{className:"grid grid-cols-1 gap-14 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 py-10 px-2",children:a.map((s,r)=>e.jsxs("div",{className:"card w-full overflow-hidden bg-white-fg dark:bg-black-input rounded-3xl border-2 border-[#00a651] outline-none hover:border-green-pri hover:outline-none hover:ring-2 hover:ring-green-pri dark:hover:ring-2 dark:hover:ring-green-pri p- shadow-xl transition duration-300 hover:scale-105 hover:shadow-2xl dark:text-white-text dark:shadow-lg dark:shadow-[#24382ab0]",children:[e.jsx(o,{to:s._id?`/viewdrug/${s._id}`:"/",className:"text-black-text no-underline bg-black-bg dark:bg-black-bg dark:text-white-text",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex w-2/5 flex-col",children:[e.jsx("div",{className:"w-full p-2",children:s.drugImages&&s.drugImages.length>0?e.jsx("img",{src:s.drugImages[0].imageUrl,alt:`Drug ${r+1}`,className:"h-44 w-full object-contain",onError:c=>console.error(`Error loading image for Drug ${r+1}:`,c)}):e.jsx("img",{src:L,alt:`Drug ${r+1}`,className:"h-44 w-full object-contain",onLoad:()=>console.log(`Placeholder image loaded for Drug ${r+1}`),onError:()=>console.error(`Error loading placeholder image for Drug ${r+1}`)})}),e.jsx("div",{className:"w-full pr-8 sm:pr-12 md:pr-[70px] lg:pr-5 ",children:e.jsxs("p",{className:"text-md text-right text-[#00a651]",children:[s.convertToLBP," LBP"]})}),e.jsx("div",{className:"w-full pr-8 sm:pr-12  md:pr-[70px] lg:pr-5 ",children:e.jsxs("p",{className:"text-md text-right text-[#00a651]",children:[s.convertToUSD," USD"]})}),e.jsx("div",{className:"w-full pr-8 sm:pr-12  md:pr-[70px] lg:pr-5 ",children:e.jsxs("p",{className:"text-md text-right text-[#00a651]",children:[s.pillPriceLB," LBP/Pill"]})})]}),e.jsxs("div",{className:"w-3/5 p-4 text-left",children:[e.jsx("h2",{className:"mb-2 text-2xl font-semibold",children:s.drugName}),e.jsxs("p",{className:"mb-2 text-sm italic text-gray-600 dark:text-gray-400",children:[s.ingredientsAndstrength,e.jsxs("span",{className:"ml-1",children:[e.jsx("span",{className:"mr-1",children:s.dosageValueN}),e.jsx("span",{className:"",children:s.dosageUnitN})]})]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("span",{className:"font-normal mr-1",children:"Dose:"}),e.jsx("span",{className:"mr-1",children:s.dosageValueN}),e.jsx("span",{className:"",children:s.dosageUnitN})]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("span",{className:"font-normal mr-1",children:"Presentation: "}),s.presentationContentQty]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("span",{className:"font-normal mr-1",children:"Form: "}),s.form]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("span",{className:"font-normal mr-1",children:"Route: "}),s.route]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("span",{className:"font-normal mr-1",children:"Type: "}),s.type]})]})]})}),e.jsxs("div",{className:"flex items-center w-full justify-between bg-white-contents p-1 sm:px-3 pr-2",children:[e.jsxs("div",{className:"edit-delete flex flex-col sm:flex-row",children:[e.jsxs(o,{to:s._id?`/editdrug/${s._id}`:"/",className:`text-teal-600 hover:underline ${s._id?"":"cursor-not-allowed"}`,children:[e.jsx(w,{className:"mr-2 inline-block"}),"Edit"]}),e.jsxs("button",{onClick:()=>b(s._id),className:"ml-2 text-red-600 hover:underline",children:[e.jsx(k,{className:"mr-2 inline-block"}),"Delete"]})]}),e.jsx("div",{className:"flex items-center justify-around",children:e.jsx(o,{to:"/substitute",children:e.jsx("img",{src:y,className:"w-[120px] cursor-pointer",alt:""})})}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row w-fit items-center justify-center gap-1",children:[e.jsx("p",{className:" text-xs text-black-text",children:"Made in Lebanon"}),e.jsx("img",{className:"w-[50px]",src:D,alt:""})]})]})]},r))})]})}export{I as default};
