import{r as n,R as b,g as x,j as e,L as E,h as P,i as T,l as L,A as d,m as I}from"./index-nT-sMeGS.js";const h="countriesData",$=()=>{const[l,u]=n.useState([]),[s,f]=n.useState(""),[v,o]=n.useState(!0);n.useEffect(()=>{(async()=>{try{o(!0);let r=localStorage.getItem(h);r&&(u(JSON.parse(r)),o(!1));const C=(await d.get("/api/country/v1.0/countries")).data,i=await Promise.all(C.map(async a=>{try{const H=(await d.get(`/api/Governorates/v1.0/Governorates/${a.guid}`)).data,G=a.staticCountryGuid,R=await Promise.all(H.map(async c=>{try{const A=(await d.get(`/api/District/v1.0/district/${c.guid}`)).data;return{...c,districtsData:A}}catch(p){return console.log(`Error fetching districts data for governorate ${c.code}:`,p),c}}));return{...a,governoratesData:R,staticCountryGuid:G}}catch(m){return console.log(`Error fetching governorates data for country ${a.code}:`,m),a}}));u(i),o(!1),localStorage.setItem(h,JSON.stringify(i)),I.setItem("countriesData",i)}catch(r){console.log("Error fetching countries data:",r),o(!1)}})()},[]);const D=b.useMemo(()=>[{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Name (Arabic)",accessor:"nameAr"},{Header:"Governorate Code",accessor:"governoratesData[0].code"},{Header:"Governorate Name",accessor:"governoratesData[0].name"},{Header:"Governorate Name (Arabic)",accessor:"governoratesData[0].nameAr"},{Header:"District Code",accessor:"governoratesData[0].districtsData[0].code"},{Header:"District Name",accessor:"governoratesData[0].districtsData[0].name"},{Header:"District Name (Arabic)",accessor:"governoratesData[0].districtsData[0].nameAr"}],[]),j=b.useMemo(()=>{const t=s?s.toLowerCase().trim():"";return l.filter(r=>Object.values(r).some(g=>String(g).toLowerCase().includes(t)))},[l,s]),{getTableProps:N,getTableBodyProps:w,headerGroups:k,rows:S,prepareRow:y}=x.useTable({columns:D,data:j},x.useSortBy);return e.jsxs("div",{className:"container mx-auto pt-10 md:px-10 text-black-text dark:text-white-text",children:[e.jsx("h2",{className:"text-2xl text-center font-bold mb-4",children:"Countries Info List"}),e.jsxs("div",{className:"flex justify-between items-center pb-4 py-6",children:[e.jsx("input",{label:"Search countries",value:s,onChange:t=>f(t.target.value),autoComplete:"off",className:"rounded-md dark:border-white-text text-black-text dark:text-white-text bg-white-bg dark:bg-black-bg dark:focus:border-transparent outline-none focus:border-green-pri focus:outline-none focus:ring-2 focus:ring-green-pri dark:focus:ring-2 dark:focus:ring-green-pri"}),e.jsx(E,{to:"/geo/new",className:"med-btn-pri",children:"New"})]}),v?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("div",{className:"loader ease-linear rounded-full border-8 border-t-8 border-green-pri absolute top-80 right-50 h-20 w-20"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{...N(),className:"min-w-full table-auto",children:[e.jsx("thead",{children:k.map(t=>e.jsx("tr",{...t.getHeaderGroupProps(),children:t.headers.map(r=>e.jsxs("th",{...r.getHeaderProps(r.getSortByToggleProps()),className:"border border-gray-300 p-2 dark:border-black-contents p-2",children:[r.render("Header"),e.jsx("span",{children:r.isSorted?r.isSortedDesc?e.jsx(P,{}):e.jsx(T,{}):e.jsx(L,{})})]}))}))}),e.jsx("tbody",{...w(),children:S.map(t=>(y(t),e.jsx("tr",{...t.getRowProps(),className:"border text-center border-gray-300 p-2 dark:border-black-contents dark:hover:bg-black-contents",children:t.cells.map(r=>e.jsx("td",{...r.getCellProps(),className:"border-b border-gray-300 p-2 dark:border-black-contents",children:r.render("Cell")}))})))})]})})]})};export{$ as default};
